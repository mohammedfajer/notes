"use strict";(self.webpackChunknotes=self.webpackChunknotes||[]).push([[5696],{5788:(e,t,n)=>{n.d(t,{Iu:()=>g,yg:()=>c});var a=n(1504);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},g=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},m="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},y=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,p=e.parentName,g=l(e,["components","mdxType","originalType","parentName"]),m=s(n),y=o,c=m["".concat(p,".").concat(y)]||m[y]||d[y]||i;return n?a.createElement(c,r(r({ref:t},g),{},{components:n})):a.createElement(c,r({ref:t},g))}));function c(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,r=new Array(i);r[0]=y;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[m]="string"==typeof e?e:o,r[1]=l;for(var s=2;s<i;s++)r[s]=n[s];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}y.displayName="MDXCreateElement"},2968:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>f,contentTitle:()=>h,default:()=>A,frontMatter:()=>u,metadata:()=>N,toc:()=>w});var a=n(5072),o=(n(1504),n(5788));const i=n.p+"assets/images/refresh_vs-96137ec6ddf15fa250914a25d929749c.png",r=n.p+"assets/images/w2_ue5_ia-778bdcc034dfe2c0541b90e55dd639f7.png",l=n.p+"assets/images/w2_imc-3205e0f46ea11c6471ed6e538c07a655.png",p=n.p+"assets/images/w2_input_action_editor-076e146075450a326e5d89a144a371cb.png",s=n.p+"assets/images/w2_log-8a267ae9d96a0d1530053cf805450a20.png",g=n.p+"assets/images/w2_debug_vs-27ffc04e2fdb92ad808b61bc52099c06.png",m=n.p+"assets/images/w2_breakpoint-8be09f078f264ee54f808d69b45e3bcd.png",d="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAbCAMAAABP9I/XAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABCUExURc/W5dDX5s7V5NHY5rrSwjl+Npe/ms/V5DF5Lm+nbMzb3lGLTTR7MIKzgdDX5USEQKrJrs/W5FyYWcbZ0M/V5QAAACicVIEAAAAWdFJOU////////////////////////////wAB0sDkAAAACXBIWXMAABJxAAAScAHqx0vPAAAArklEQVQoU3WRUQ7DIAxDp6SqUpSpVcX9zzq7CYyyzvBBzMMK8NJH/bXrg0jnclTQKqIqwyAtsBe5CbYIcFuxnmjEm51aak04aKSY+7780GKGjXWiGUJthUija7NtX+LARaPztM2joyH7kr9R9E7Sdj9YzvRZ2lMMtG9a40q3vo94zHs2A2ijHOgNX0IU8DdbEQAXk3CnmXmJbKNRMZcBoaR5/Tw+0L2c6a7cfKZVP+cJDxpCUDesAAAAAElFTkSuQmCC",y="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAbCAMAAABVyG9ZAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAABpUExURc/W5dDX5tLb69Lc7NLc68/V5MvJ1srI1MrI1cvL2Jc4JpAnE5IsGJY3JcvK15IqFYoXAIwdBpApFJMuGowcBY4hC5ItGZEpFJAoE5g8K5QwHpc7Ks/W5MzO28zN2szN29Hb6tHb6wAAAPdk/50AAAAjdFJOU/////////////////////////////////////////////8AZimDlgAAAAlwSFlzAAASdwAAEnABPJ6o0gAAAOtJREFUKFN1UNsKxTAI69vYw6At7OGUgvj/P3mS6G6wabu2xkRn8U8rbvPV3Yr5/PDiTHh1CCLhHgmfYoGG+2MLRq1EDoMGZchiMTdbFixuvKBGVuTYtqd1icFZi4fttRFodScLoRm1cO1CaExU+slKqA5mMnbWGgk1sRhkh7hfrAaWKvC/otNREyKLgWQBvNdStZwhoF5rC085dahpbH0btP4DFKg6JG2acWMhjqcmH/TLQKKOxzRgfCJdEhS5WMTxFYOOlSwliBkHZZ4sHav7ysgxeTm7XVEQoGYYcYoqXTtYiaxMV1Cn+fQ/6gJP/cVG/IIAAAAASUVORK5CYII=",c=n.p+"assets/images/w2_ue5_condition-648e7b4aca8187b31fa8cb4c3c78383f.png",u={},h="Week 2 - Mouse Input and Spawning Game Objects",N={unversionedId:"GAP5006 Game Dyanmics/tutorial-ue5/week2",id:"GAP5006 Game Dyanmics/tutorial-ue5/week2",title:"Week 2 - Mouse Input and Spawning Game Objects",description:"Task Sheet 2 - Working with UE5",source:"@site/docs/GAP5006 Game Dyanmics/tutorial-ue5/week2.md",sourceDirName:"GAP5006 Game Dyanmics/tutorial-ue5",slug:"/GAP5006 Game Dyanmics/tutorial-ue5/week2",permalink:"/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/docs/GAP5006 Game Dyanmics/tutorial-ue5/week2",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Week 1 - Introduction to UE5",permalink:"/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/docs/GAP5006 Game Dyanmics/tutorial-ue5/week1"},next:{title:"Week 3 - Using C++ and Blueprint",permalink:"/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/docs/GAP5006 Game Dyanmics/tutorial-ue5/week3"}},f={},w=[{value:"Introduction",id:"introduction",level:2},{value:"Mouse Input",id:"mouse-input",level:2},{value:"Using Mouse Input",id:"using-mouse-input",level:3},{value:"Responding to Mouse Inputs",id:"responding-to-mouse-inputs",level:3},{value:"Turn Method",id:"turn-method",level:4},{value:"Lookup Method",id:"lookup-method",level:4},{value:"Moving an Object in a Rotated Direction",id:"moving-an-object-in-a-rotated-direction",level:2},{value:"Debugging",id:"debugging",level:2},{value:"Debugging C++ Code in UE5",id:"debugging-c-code-in-ue5",level:3},{value:"Using UE5&#39;s Log Output",id:"using-ue5s-log-output",level:3},{value:"Using VS2022&#39;s Debugging Tools",id:"using-vs2022s-debugging-tools",level:3},{value:"Spawning Objects",id:"spawning-objects",level:2},{value:"Points to Consider",id:"points-to-consider",level:2},{value:"Exercises",id:"exercises",level:2},{value:"Spawning Enemies within a Spawn Volume",id:"spawning-enemies-within-a-spawn-volume",level:3},{value:"Handling Collisions",id:"handling-collisions",level:3},{value:"Dynamically Changing A Material Instance",id:"dynamically-changing-a-material-instance",level:3},{value:"Bonus Exercise",id:"bonus-exercise",level:2},{value:"More Points to Consider",id:"more-points-to-consider",level:2}],b={toc:w},C="wrapper";function A(e){let{components:t,...n}=e;return(0,o.yg)(C,(0,a.c)({},b,n,{components:t,mdxType:"MDXLayout"}),(0,o.yg)("h1",{id:"week-2---mouse-input-and-spawning-game-objects"},"Week 2 - Mouse Input and Spawning Game Objects"),(0,o.yg)("admonition",{type:"info"},(0,o.yg)("p",{parentName:"admonition"},"Task Sheet 2 - Working with UE5")),(0,o.yg)("h2",{id:"introduction"},"Introduction"),(0,o.yg)("p",null,"This week we are going to extend the simple object we created in Worksheet 1, so that a mouse can be used with input, and projectiles can be fired."),(0,o.yg)("p",null,"Do the following:"),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Open the ",(0,o.yg)("strong",{parentName:"p"},"Epic Games Launcher"),", to load UE5 and click on the Launch button for ",(0,o.yg)("strong",{parentName:"p"},"Version 5.2.1")," (or select the down arrow to select the version required). The UE5 ",(0,o.yg)("strong",{parentName:"p"},"project browser")," should be displayed.")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Open project ",(0,o.yg)("strong",{parentName:"p"},"GDyn1"),". (Alternatively, double-click on the ",(0,o.yg)("strong",{parentName:"p"},"GDyn1.uproject")," file, in the folder where you stored the project from the previous worksheet). The previous UE5 project should be opened with the default ",(0,o.yg)("strong",{parentName:"p"},"GDMap")," setup displayed.")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"It is good practice to refresh the ",(0,o.yg)("strong",{parentName:"p"},"VS")," files, on opening a UE5 C++ project. Do this through ",(0,o.yg)("strong",{parentName:"p"},"Tools -> Refresh Visual Studio Project"),"."))),(0,o.yg)("div",{class:"image-container"},(0,o.yg)("img",{src:i,width:"60%",alt:"Refresh VS"})),(0,o.yg)("h2",{id:"mouse-input"},"Mouse Input"),(0,o.yg)("p",null,"At present, unless you completed the bonus tasks, the cube can only be moved in the world X and Y axes, even when the object is rotated. It would be useful to be able to face a direction we want to move in, using mouse input, and then use the keys to move in the selected direction, or at 90","\xb0"," degrees to it. "),(0,o.yg)("h3",{id:"using-mouse-input"},"Using Mouse Input"),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},"Create two input actions for turn called ",(0,o.yg)("strong",{parentName:"li"},"IA_Turn")," to use ",(0,o.yg)("strong",{parentName:"li"},"Axis1D (float)")," as the value type and one for lookup called ",(0,o.yg)("strong",{parentName:"li"},"IA_Lookup")," to use ",(0,o.yg)("strong",{parentName:"li"},"Axis1D (float)")," as the value type. To create this navigate to the ",(0,o.yg)("strong",{parentName:"li"},"Content Drawer")," under the Input folder (create one if not created). Right-click and select ",(0,o.yg)("strong",{parentName:"li"},"Input")," and then ",(0,o.yg)("strong",{parentName:"li"},"Input Action"),".")),(0,o.yg)("div",{class:"image-container"},(0,o.yg)("img",{src:r,width:"90%",alt:"Refresh VS"})),(0,o.yg)("ol",{start:2},(0,o.yg)("li",{parentName:"ol"},"Next open the ",(0,o.yg)("strong",{parentName:"li"},"Input Mapping Context (IMC)")," and the mapping for turn and lookup as shown below. For the ",(0,o.yg)("strong",{parentName:"li"},"turn")," make sure to select ",(0,o.yg)("inlineCode",{parentName:"li"},"Mouse X")," as the input device and for ",(0,o.yg)("strong",{parentName:"li"},"lookup")," select the ",(0,o.yg)("inlineCode",{parentName:"li"},"Mouse Y")," input device.")),(0,o.yg)("div",{class:"image-container"},(0,o.yg)("img",{src:l,width:"40%",alt:"Refresh VS"})),(0,o.yg)("ol",{start:3},(0,o.yg)("li",{parentName:"ol"},"Now head to your C++ Visual studio project and open ",(0,o.yg)("strong",{parentName:"li"},"GD_Pawn.h")," header file.  Under the protected access specifier add the code for input actions as shown below.")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-cpp"},'// ...\nUPROPERTY(EditAnywhere, Category = "Enhanced Input")\nUInputAction *InputTurn;\n\nUPROPERTY(EditAnywhere, Category = "Enhanced Input")\nUInputAction *InputLookup;\n// ...\n')),(0,o.yg)("ol",{start:4},(0,o.yg)("li",{parentName:"ol"},"Now define the input callback methods for ",(0,o.yg)("strong",{parentName:"li"},"turn")," and ",(0,o.yg)("strong",{parentName:"li"},"lookup")," input actions as shown below.")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-cpp"},"// ...\nvoid Turn(const FInputActionValue &Value);\nvoid Lookup(const FInputActionValue &Value);\n// ...\n")),(0,o.yg)("p",null,"Now open the cpp ",(0,o.yg)("strong",{parentName:"p"},"GD_Pawn.cpp")," source file. Inside ",(0,o.yg)("strong",{parentName:"p"},"SetupPlayerInputComponent(...)")," method setup the function binding for the input actions we have created."),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-cpp"},"// ...\nPEI->BindAction(InputTurn, ETriggerEvent::Triggered, this, &AGD_Pawn::Turn);\nPEI->BindAction(InputLookup, ETriggerEvent::Triggered, this, &AGD_Pawn::Lookup);\n// ...\n")),(0,o.yg)("ol",{start:5},(0,o.yg)("li",{parentName:"ol"},"Inside the editor viewport select the ",(0,o.yg)("strong",{parentName:"li"},"pawn")," cube, and inside the ",(0,o.yg)("strong",{parentName:"li"},"Details")," panel under ",(0,o.yg)("u",null,"Enhanced Input")," setup the input actions we just created as shown below.")),(0,o.yg)("div",{class:"image-container"},(0,o.yg)("img",{src:p,width:"40%",alt:"Refresh VS"})),(0,o.yg)("h3",{id:"responding-to-mouse-inputs"},"Responding to Mouse Inputs"),(0,o.yg)("p",null,"Now that we've created two methods to respond to mouse movements and bound them to the input action mappings. What left is to code the logic for them."),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},"Within the ",(0,o.yg)("strong",{parentName:"li"},"GD_Pawn.cpp")," file, add the following code logic.")),(0,o.yg)("h4",{id:"turn-method"},"Turn Method"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("strong",{parentName:"li"},"Turn(..)")," method should use the ",(0,o.yg)("strong",{parentName:"li"},(0,o.yg)("inlineCode",{parentName:"strong"},"FInputActionValue"))," parameter to receive input and extract the axis value from it using ",(0,o.yg)("inlineCode",{parentName:"li"},"Value.Get<FInputActionValue::Axis1D>()"),". "),(0,o.yg)("li",{parentName:"ul"},"Define a turn rate variable ",(0,o.yg)("strong",{parentName:"li"},"TurnRate")," to control how fast the pawn turns. Adjust this value as needed."),(0,o.yg)("li",{parentName:"ul"},"Calculate the amount of turn based on the axis value, turn rate, and the delta time from ",(0,o.yg)("strong",{parentName:"li"},(0,o.yg)("inlineCode",{parentName:"strong"},"GetWorld()->GetDeltaSeconds()")),"."),(0,o.yg)("li",{parentName:"ul"},"Get the current rotation of the pawn using ",(0,o.yg)("strong",{parentName:"li"},"GetActorRotation()"),"."),(0,o.yg)("li",{parentName:"ul"},"Update the ",(0,o.yg)("u",null,"Yaw")," component of the rotation (",(0,o.yg)("inlineCode",{parentName:"li"},"NewRotation.Yaw"),") by adding the calculated turn amount."),(0,o.yg)("li",{parentName:"ul"},"Finally set the new rotation of the pawn using ",(0,o.yg)("strong",{parentName:"li"},(0,o.yg)("inlineCode",{parentName:"strong"},"SetActorRotation(NewRotation)")),".")),(0,o.yg)("p",null,"The following is a simple ",(0,o.yg)("strong",{parentName:"p"},"pseudocode")," (not real code) to illustrate the points."),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-text"},"Function Turn(Value)\n    AxisValue = ExtractAxisValue(Value)\n    TurnRate = 100.0 // Adjust as needed\n    TurnAmount = AxisValue * TurnRate * DeltaTime\n    CurrentRotation = GetPawnRotation()\n    NewRotation.Yaw = CurrentRotation.Yaw + TurnAmount\n    SetPawnRotation(NewRotation)\nEnd Function\n")),(0,o.yg)("h4",{id:"lookup-method"},"Lookup Method"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("strong",{parentName:"li"},"Lookup(..)")," method should use the ",(0,o.yg)("strong",{parentName:"li"},(0,o.yg)("inlineCode",{parentName:"strong"},"FInputActionValue"))," parameter to receive input and extract the axis value from it using ",(0,o.yg)("inlineCode",{parentName:"li"},"Value.Get<FInputActionValue::Axis1D>()"),". "),(0,o.yg)("li",{parentName:"ul"},"Define a look rate variable ",(0,o.yg)("strong",{parentName:"li"},"LookRate")," to control how fast the camera rotates. Adjust this value as needed."),(0,o.yg)("li",{parentName:"ul"},"Calculate the amount of rotation based on the axis value, look rate, and delta time from ",(0,o.yg)("strong",{parentName:"li"},(0,o.yg)("inlineCode",{parentName:"strong"},"GetWorld()->GetDeltaSeconds()")),"."),(0,o.yg)("li",{parentName:"ul"},"Get the current rotation of the camera component using ",(0,o.yg)("strong",{parentName:"li"},(0,o.yg)("inlineCode",{parentName:"strong"},"Camera->GetComponentRotation()")),"."),(0,o.yg)("li",{parentName:"ul"},"Update the ",(0,o.yg)("u",null,"Pitch")," component of the rotation, clamping it between -60 and -20 degrees to limit the camera's vertical movement."),(0,o.yg)("li",{parentName:"ul"},"Set the new rotation of the camera component using ",(0,o.yg)("strong",{parentName:"li"},(0,o.yg)("inlineCode",{parentName:"strong"},"Camera->SetWorldRotation(NewCameraRotation)")),";")),(0,o.yg)("p",null,"The following is a simple ",(0,o.yg)("strong",{parentName:"p"},"pseudocode")," (not real code) to illustrate the points."),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-text"},"Function Look(Value)\n    AxisValue: float = ExtractAxisValue(Value)\n    LookRate: float = 100.0 // Adjust as needed\n    LookAmount: float = AxisValue * LookRate * DeltaTime\n    NewCameraRotation: FRotator = GetCameraRotation()\n    NewCameraRotation.Pitch = ClampAngle(CurrentCameraRotation.Pitch + LookAmount, -60.0, -20.0)\n    SetCameraRotation(NewCameraRotation)\nEnd Function\n")),(0,o.yg)("ol",{start:2},(0,o.yg)("li",{parentName:"ol"},"Within the UE5 Editor, ",(0,o.yg)("strong",{parentName:"li"},"Compile")," the program. Play the game and move the mouse to rotate the object and also move the ",(0,o.yg)("inlineCode",{parentName:"li"},"pitch")," rotation of the camera up and down. Make sure to ",(0,o.yg)("strong",{parentName:"li"},"Save"),".")),(0,o.yg)("admonition",{type:"info"},(0,o.yg)("p",{parentName:"admonition"},(0,o.yg)("strong",{parentName:"p"},"Note")," how the object's rotation is changed, based on the ",(0,o.yg)("inlineCode",{parentName:"p"},"mouse X")," position. Also, the camera also moves with the pawn object, as it is attached to the object.  Note, also how the camera's ",(0,o.yg)("strong",{parentName:"p"},"pitch")," is changed with ",(0,o.yg)("inlineCode",{parentName:"p"},"mouse y")," position, but the ",(0,o.yg)("strong",{parentName:"p"},"LookUp()")," function does not change the object's rotation / position."),(0,o.yg)("p",{parentName:"admonition"},"At present, the object still only moves vertically / horizontally.  It would be useful to move the object, based on the direction the object / camera is facing / pointing.")),(0,o.yg)("h2",{id:"moving-an-object-in-a-rotated-direction"},"Moving an Object in a Rotated Direction"),(0,o.yg)("p",null,"We need to know what the object's ",(0,o.yg)("strong",{parentName:"p"},"direction")," is. UE5 stores what is called a ",(0,o.yg)("strong",{parentName:"p"},(0,o.yg)("inlineCode",{parentName:"strong"},"forward"))," vector and a ",(0,o.yg)("strong",{parentName:"p"},(0,o.yg)("inlineCode",{parentName:"strong"},"right"))," vector for an Actor object. A Pawn object is an Actor, so we can use the actor's forward / right vectors to move in the correct directions. Alternatively we can use the ",(0,o.yg)("inlineCode",{parentName:"p"},"UStaticMeshComponent")," i.e. ",(0,o.yg)("strong",{parentName:"p"},"VisibleComponent")," forward and right vectors to achieve the same behaviour."),(0,o.yg)("p",null,"Unreal Engine uses a rare ",(0,o.yg)("strong",{parentName:"p"},"left-handed"),", Z-up coordinate system, this is inconveniently divergent from most other popular 3D software packages and commonly used game engines, but different doesn't mean wrong."),(0,o.yg)("p",null,"The most important thing to remember is that the virtual space inside your Unreal project is determined by three axes: ",(0,o.yg)("strong",{parentName:"p"}," ",(0,o.yg)("span",{style:{color:"red"}}," X ")," "),",\n",(0,o.yg)("strong",{parentName:"p"}," ",(0,o.yg)("span",{style:{color:"green"}},"Y")," "),", and ",(0,o.yg)("strong",{parentName:"p"}," ",(0,o.yg)("span",{style:{color:"blue"}}," Z ")," "),". They represent the ",(0,o.yg)("strong",{parentName:"p"}," ",(0,o.yg)("span",{style:{color:"red"}}," forward/backward ")," "),", ",(0,o.yg)("strong",{parentName:"p"}," ",(0,o.yg)("span",{style:{color:"green"}}," left/right ")," "),", and ",(0,o.yg)("strong",{parentName:"p"}," ",(0,o.yg)("span",{style:{color:"blue"}}," up/down ")," ")," directions respectively."),(0,o.yg)("p",null,"Therefore to move the object alongside the actor forward and right vectors we do the following."),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-cpp"},"// ...\n\n// Get the forward and right movement components from the input\nfloat ForwardInput = Input.Y;\nfloat RightInput = Input.X;\n\n// Calculate the movement direction based on the input\nFVector ForwardVector = GetActorForwardsVector();\nFVector RightVector = GetActorRightVector();\nFVector MovementDirection = ForwardVector * ForwardInput + RightVector * RightInput;\n\n// Calculate the new location for the pawn using the current velocity\nFVector NewLocation = GetActorLocation() + \n    (CurrentVelocity * MovementDirection.GetSafeNormal() * GetWorld()->DeltaTimeSeconds);\n\n// Move the pawn to the new location\nSetActorLocation(NewLocation);\n// ...\n")),(0,o.yg)("admonition",{type:"info"},(0,o.yg)("p",{parentName:"admonition"},"It should be noted the use of functions ",(0,o.yg)("strong",{parentName:"p"},(0,o.yg)("inlineCode",{parentName:"strong"},"GetActorForwardVector()"))," and ",(0,o.yg)("strong",{parentName:"p"},(0,o.yg)("inlineCode",{parentName:"strong"},"GetActorRightVector()"))," that return ",(0,o.yg)("strong",{parentName:"p"},"FVector")," objects showing the respective direction an object is 'facing' and the 'right' vector at 90\xb0 to the forward vector, which change when an object is rotated.")),(0,o.yg)("h2",{id:"debugging"},"Debugging"),(0,o.yg)("admonition",{type:"info"},(0,o.yg)("p",{parentName:"admonition"},"We are going to use 3 main techniques for debugging our program in UE. Namely:"),(0,o.yg)("ul",{parentName:"admonition"},(0,o.yg)("li",{parentName:"ul"},"On-Screen ",(0,o.yg)("inlineCode",{parentName:"li"},"Print")," statements"),(0,o.yg)("li",{parentName:"ul"},"Output to a ",(0,o.yg)("inlineCode",{parentName:"li"},"Console-Log")," window"),(0,o.yg)("li",{parentName:"ul"},"(Most usefully) Using Visual Studio ",(0,o.yg)("inlineCode",{parentName:"li"},"Debugger")))),(0,o.yg)("h3",{id:"debugging-c-code-in-ue5"},"Debugging C++ Code in UE5"),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},"A good way to start debugging, and for use as a rudimentary feedback system, is to use a debug output message. Add the following code to any method you like, for example the ",(0,o.yg)("inlineCode",{parentName:"li"},"Move()")," method, within the ",(0,o.yg)("strong",{parentName:"li"},"GD_Pawn.cpp")," file.")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-cpp"},'if(GEngine)\n    GEngine->AddOnScreenDebugMessage(-1, 5.0f, FColor::Green, TEXT("From Move") );\n')),(0,o.yg)("ol",{start:2},(0,o.yg)("li",{parentName:"ol"},"We also need to include the ",(0,o.yg)("strong",{parentName:"li"},"Engine")," header, as it includes numerous helper attributes / functions, including debug help functions. Add:")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-cpp"},'#include "Engine/Engine.h" // Include this header to access GEngine and for debug msg\n')),(0,o.yg)("p",null,"Just below the other include files in the cpp file."),(0,o.yg)("ol",{start:3},(0,o.yg)("li",{parentName:"ol"},"Within the UE5 Editor, ",(0,o.yg)("strong",{parentName:"li"},"Compile")," and Play the game and use the mouse to rotate the object. Press the ",(0,o.yg)("strong",{parentName:"li"},"W")," and ",(0,o.yg)("strong",{parentName:"li"},"S")," keys and check that the debug message is displayed.")),(0,o.yg)("admonition",{type:"note"},(0,o.yg)("p",{parentName:"admonition"},(0,o.yg)("strong",{parentName:"p"},"Note"),": The ",(0,o.yg)("inlineCode",{parentName:"p"},"-1")," value in the ",(0,o.yg)("strong",{parentName:"p"},(0,o.yg)("inlineCode",{parentName:"strong"},"AddOnScreenDebugMessage(...)"))," ensures debug messages are added, one after another. The ",(0,o.yg)("inlineCode",{parentName:"p"},"5.0f")," is the time to display the message before it disappear. "),(0,o.yg)("p",{parentName:"admonition"},"You should note that numerous debug messages are displayed. So, the ",(0,o.yg)("inlineCode",{parentName:"p"},"Move()")," method is being called."),(0,o.yg)("p",{parentName:"admonition"},"We could continue to use on-screen debug messages, but if there are multiple messages, and if output messages need formatting, a more useful technique can be to use the ",(0,o.yg)("strong",{parentName:"p"},(0,o.yg)("inlineCode",{parentName:"strong"},"log"))," output facility available in UE5.")),(0,o.yg)("h3",{id:"using-ue5s-log-output"},"Using UE5's Log Output"),(0,o.yg)("admonition",{type:"info"},(0,o.yg)("p",{parentName:"admonition"},"UE5 features a useful log facility that provides detailed output on any items set for logging, including additions, changes, and log messages. For instance, it logs changes made to objects within the UE5 editor and provides output as a program runs.")),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},"It would be useful to output the value of the ",(0,o.yg)("inlineCode",{parentName:"li"},"CurrentVelocity")," member variable, at different stages within the program. Add the following debug message and add this code at the end of the ",(0,o.yg)("inlineCode",{parentName:"li"},"Move()")," method.")),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-cpp"},'UE_LOG(LogTemp, Warning, TEXT("Move velocity %s"), *CurrentVelocity.ToString());\n')),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},"Note")," how ",(0,o.yg)("inlineCode",{parentName:"p"},"%s")," substitutes a string value into it.  The ",(0,o.yg)("strong",{parentName:"p"},(0,o.yg)("inlineCode",{parentName:"strong"},"ToString()")," function returns a "),"TCHAR**, but we need the string, so we use the dereference pointer."),(0,o.yg)("ol",{start:2},(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Copy the above code to the end of the ",(0,o.yg)("strong",{parentName:"p"},"Tick()"),' function.  Amend text "Move()" to the respective function names.')),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Within the UE5 Editor, ",(0,o.yg)("strong",{parentName:"p"},"Compile")," the program.")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"We now want to display UE5's log window. Within the UE5 Editor, select menu option Window, Developer Tools, Output Log.  Move the window to an appropriate size / location.  It is recommended that you right-click over the output log and select Clear Log to reduce the current output.")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Play the game and use the mouse to rotate the object.  Press the ",(0,o.yg)("strong",{parentName:"p"},"W")," and ",(0,o.yg)("strong",{parentName:"p"},"S")," keys and check that the output log messages are displayed.  Your output should look similar to below."))),(0,o.yg)("div",{class:"image-container"},(0,o.yg)("img",{src:s,width:"60%",alt:"Refresh VS"})),(0,o.yg)("admonition",{type:"info"},(0,o.yg)("p",{parentName:"admonition"},"Firstly, you should note that there are a large number of outputs, as each function is called every frame. "),(0,o.yg)("p",{parentName:"admonition"},"We know VS is very good for debugging C++ programs.  It would be useful to be able to use VS's debug facilities.")),(0,o.yg)("h3",{id:"using-vs2022s-debugging-tools"},"Using VS2022's Debugging Tools"),(0,o.yg)("p",null,"It would be useful to be able to put breakpoints within the project to check where values are changed.  Do the following to setup the project so that VS is used for debugging."),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Close the UE5 Editor.")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Within VS, change the Solution Configuration from Development, or similar, to ",(0,o.yg)("strong",{parentName:"p"},"DebugGame Editor"),", as partially shown below."))),(0,o.yg)("div",{class:"image-container"},(0,o.yg)("img",{src:g,width:"40%",alt:"Refresh VS"})),(0,o.yg)("ol",{start:3},(0,o.yg)("li",{parentName:"ol"},"Place a ",(0,o.yg)("strong",{parentName:"li"},"Breakpoint")," within the ",(0,o.yg)("strong",{parentName:"li"},"Move()")," method or/and ",(0,o.yg)("strong",{parentName:"li"},"Tick()")," method, by using the ",(0,o.yg)("strong",{parentName:"li"},"F9")," key, or equivalent, in each function, as partially shown below.")),(0,o.yg)("div",{class:"image-container"},(0,o.yg)("img",{src:m,width:"80%",alt:"Refresh VS"})),(0,o.yg)("ol",{start:4},(0,o.yg)("li",{parentName:"ol"},"Run the program, using Start program green arrow, or by pressing the ",(0,o.yg)("strong",{parentName:"li"},"F5")," key. The program should build the game, if required, and then open the UE5 Editor.")),(0,o.yg)("div",{class:"image-container"},(0,o.yg)("img",{src:d,width:"2%",alt:"Refresh VS"})),(0,o.yg)("admonition",{type:"info"},(0,o.yg)("p",{parentName:"admonition"},(0,o.yg)("strong",{parentName:"p"},"Note"),": if you get error: \u201cUnable to start program...\u201d, or similar, it means that the Engine project is set as the default project.  If so, right-click over the GDyn1 project, from within the Solution Explorer panel, and select Set as StartUp project, and then press F5 to try again.")),(0,o.yg)("ol",{start:5},(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Within the UE5 Editor, press ",(0,o.yg)("strong",{parentName:"p"},"Play"),".  The program should return to VS2022, at the ",(0,o.yg)("strong",{parentName:"p"},"Breakpoint"),", as the ",(0,o.yg)("strong",{parentName:"p"},(0,o.yg)("inlineCode",{parentName:"strong"},"Move()"))," function is called every frame. It would be better if we only 'stop' the program when a ",(0,o.yg)("strong",{parentName:"p"},"W")," or ",(0,o.yg)("strong",{parentName:"p"},"S")," key is pressed.  ")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Firstly, stop the program in VS2022, by pressing ",(0,o.yg)("strong",{parentName:"p"},"Shift F5"),", or by pressing the red square, toolbar icon."))),(0,o.yg)("div",{class:"image-container"},(0,o.yg)("img",{src:y,width:"2%",alt:"Refresh VS"})),(0,o.yg)("ol",{start:7},(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Right-click over the Breakpoint and select the ",(0,o.yg)("strong",{parentName:"p"},"Conditions")," ... option. ")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Type in ",(0,o.yg)("inlineCode",{parentName:"p"},"ForwardVector.X != 0")," in the condition field, as show below. This a dummy example, you can set it to different conditions to see its behaviour.")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Click on Close. Within the UE5 Editor or VS, press Play or run."))),(0,o.yg)("div",{class:"image-container"},(0,o.yg)("img",{src:c,width:"80%",alt:"Refresh VS"})),(0,o.yg)("h2",{id:"spawning-objects"},"Spawning Objects"),(0,o.yg)("admonition",{type:"info"},(0,o.yg)("p",{parentName:"admonition"},"It would be useful to be able to fire projectiles from the cube. We will need to be able to ",(0,o.yg)("strong",{parentName:"p"},"spawn")," objects within the game.")),(0,o.yg)("p",null,"It would be useful to ",(0,o.yg)("strong",{parentName:"p"},(0,o.yg)("inlineCode",{parentName:"strong"},"fire"))," projectiles in the direction the player object is pointing. We can spawn ",(0,o.yg)("inlineCode",{parentName:"p"},"actors")," directly from classes that have been created in C++. Do the following:"),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Within the UE5 Editor / Content Browser, create a ",(0,o.yg)("strong",{parentName:"p"},"new C++ Class")," that is based on an ",(0,o.yg)("u",null,"Actor"),", and name it ",(0,o.yg)("strong",{parentName:"p"},"Projectile"),".")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Within the ",(0,o.yg)("strong",{parentName:"p"},"Projectile")," header file, add, after ",(0,o.yg)("strong",{parentName:"p"},"public:")," the following:"),(0,o.yg)("ul",{parentName:"li"},(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},"A function/method to fire in a direction. The shoot direction should be passed in as a ",(0,o.yg)("inlineCode",{parentName:"p"},"const FVector&"),".")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},"A member variable for the collision component (we will use a ",(0,o.yg)("strong",{parentName:"p"},"USphereComponent"),") and one for the movement component (",(0,o.yg)("strong",{parentName:"p"},"UProjectileMovementComponent"),"). These are going to be viewable in editor, so add the ",(0,o.yg)("u",null,(0,o.yg)("inlineCode",{parentName:"p"},"UPROPERTY"))," tag and use ",(0,o.yg)("strong",{parentName:"p"},"VisibleAnywhere")," for them. You should also add them to categories. This is also done in the ",(0,o.yg)("strong",{parentName:"p"},"UPROPERTY brackets"),". The syntax is ",(0,o.yg)("inlineCode",{parentName:"p"},"\u201cCategory = MYCATEGORY\u201d"),". Make one the ",(0,o.yg)("strong",{parentName:"p"},"\u201cProjectile\u201d")," category, and the other ",(0,o.yg)("strong",{parentName:"p"},"\u201cMovement\u201d"),".")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},"A member variable for the static mesh (check the variable type where you\u2019ve added a static mesh previously if you don\u2019t remember the type).")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},"A static float for the ",(0,o.yg)("strong",{parentName:"p"},"initial radius")," the projectile will spawn at, and a float for the ",(0,o.yg)("strong",{parentName:"p"},"initial speed"),". The latter should be ",(0,o.yg)("strong",{parentName:"p"},"Editable")," from Anywhere in the UE5 editor. Use ",(0,o.yg)("inlineCode",{parentName:"p"},"UPROPERTY")," to add that and set a category of ",(0,o.yg)("strong",{parentName:"p"},"\u201cGameplay\u201d"),".")))),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Also, add the includes for a ",(0,o.yg)("strong",{parentName:"p"},"SphereComponent")," and a ",(0,o.yg)("strong",{parentName:"p"},"ProjectileMovementComponent")," just before the ",(0,o.yg)("inlineCode",{parentName:"p"},".generated.h")," line, so that the component classes are included. You should use the unreal engine docs or google to find these include paths. ")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Open the ",(0,o.yg)("em",{parentName:"p"},"Projectile")," ",(0,o.yg)("strong",{parentName:"p"},".cpp")," file, and just after the ",(0,o.yg)("inlineCode",{parentName:"p"},'#include "Projectile.h"')," line, initialise your static variable for the radius to ",(0,o.yg)("strong",{parentName:"p"},"15.0f"),". If you don\u2019t remember how to do this, think back to how you made a singleton in SDL. You initialise a static variable there. ")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Within the ",(0,o.yg)("em",{parentName:"p"},"Projectile")," ",(0,o.yg)("strong",{parentName:"p"},".cpp")," file, add the following code to the constructor:"),(0,o.yg)("ul",{parentName:"li"},(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},"Set our ",(0,o.yg)("strong",{parentName:"p"},"initial speed")," variable to be 1000.")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},"Create the ",(0,o.yg)("u",null,"collision component"),", the ",(0,o.yg)("u",null,"static mesh component")," and the ",(0,o.yg)("u",null,"projectile movement component")," using the ",(0,o.yg)("strong",{parentName:"p"},(0,o.yg)("inlineCode",{parentName:"strong"},"CreateDefaultSubObject<>()"))," function you used last week. Give them suitable names.")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},"We\u2019re next going to call ",(0,o.yg)("strong",{parentName:"p"},"\u201cInitSphereRadius\u201d")," on the collision component and pass in the ",(0,o.yg)("strong",{parentName:"p"},"initial radius")," we set up earlier. ")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},"Make the collision component the ",(0,o.yg)("strong",{parentName:"p"},"Root")," of the Actor, again, use last week\u2019s code to check how to do this. ")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},"We need to tell the static mesh what mesh to use. Rather than pass it in, like we have done previously, we\u2019re going to reference it in code. Generally it\u2019s going to be better to pass this information in, but it\u2019s good to know how we can go about it if that isn\u2019t an option. The line looks like this: "),(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre",className:"language-cpp"},'UStaticMesh *meshToUse = Cast<UStaticMesh>(StaticLoadObject(UStaticMesh::StaticClass(),\nNULL, TEXT("/Engine/BasicShapes/Sphere")));\n')),(0,o.yg)("p",{parentName:"li"},"  It\u2019s pretty ugly, but should get us what we need. We load the object as a generic object type, but tell the engine to look for a static mesh. We then cast the result to a static mesh and store that locally for use. ")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},"The next bit is a little bit hard to detail all in one go, so I\u2019m going to give you the snippets. You\u2019ll likely need to change the variable names to match your existing code. "),(0,o.yg)("p",{parentName:"li"},"  If the mesh is valid, we need to: bind it to our static mesh component."),(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre",className:"language-cpp"},"if(meshToUse) {\n    // Bind static mesh\n    staticMeshComponent->SetStaticMesh(meshToUse)\n")),(0,o.yg)("p",{parentName:"li"},"  Next we set it up with a material."),(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre",className:"language-cpp"},"    // Find and instance a material for the mesh\n    static ConstructorHelpers::FObjectFinder <UMaterial> matGreenFinder \n        (TEXT(\"MaterialInstanceConstant'/Engine/EditorMaterials/WidgetMaterial_Y'\"));\n\n    UMaterialInstanceDynamic *dynMaterial = UMaterialInstanceDynamic::Create(matGreenFinder.Object, NULL);\n")),(0,o.yg)("p",{parentName:"li"},"  Then we set up the dimensions so the projectile is the size of our radius."),(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre",className:"language-cpp"},"    // Use the bounds of the mesh to scale it so that it is the size of our radius\n    FVector minB, maxB;\n    staticMeshComponent->GetLocalBounds(minB, maxB);\n    float scale = initRad / minB.X;\n    staticMeshComponent->SetWorldScale3D(FVector(scale, scale, scale));\n")),(0,o.yg)("p",{parentName:"li"},"  We\u2019ll also disable collision on the static mesh, as that is why we have the simpler sphere collider.\nWe finish by attaching the resulting component to the root object."),(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre",className:"language-cpp"},'    // Disable mesh collision and attach the mesh to our root component (The sphere collider)\n    staticMeshComponent->SetCollisionProfileName("NoCollision");\n    staticMeshComponent->SetupAttachment(RootComponent);\n}    \n'))),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},"Now we\u2019re going to setup the ",(0,o.yg)("strong",{parentName:"p"},"projectile component"),". Inside the component class are several variables we\u2019ll need to set. Below are the variables and their values:"),(0,o.yg)("table",{parentName:"li"},(0,o.yg)("thead",{parentName:"table"},(0,o.yg)("tr",{parentName:"thead"},(0,o.yg)("th",{parentName:"tr",align:null},"Variable"),(0,o.yg)("th",{parentName:"tr",align:null},"Value"))),(0,o.yg)("tbody",{parentName:"table"},(0,o.yg)("tr",{parentName:"tbody"},(0,o.yg)("td",{parentName:"tr",align:null},"InitialSpeed"),(0,o.yg)("td",{parentName:"tr",align:null},"The initial speed variable we stored")),(0,o.yg)("tr",{parentName:"tbody"},(0,o.yg)("td",{parentName:"tr",align:null},"MaxSpeed"),(0,o.yg)("td",{parentName:"tr",align:null},"3000")),(0,o.yg)("tr",{parentName:"tbody"},(0,o.yg)("td",{parentName:"tr",align:null},"bRotationFollowsVelocity"),(0,o.yg)("td",{parentName:"tr",align:null},"True")),(0,o.yg)("tr",{parentName:"tbody"},(0,o.yg)("td",{parentName:"tr",align:null},"bShouldBounce"),(0,o.yg)("td",{parentName:"tr",align:null},"True")),(0,o.yg)("tr",{parentName:"tbody"},(0,o.yg)("td",{parentName:"tr",align:null},"Bounciness"),(0,o.yg)("td",{parentName:"tr",align:null},"0.3"))))),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},"Finally for the constructor, we need to tell the ",(0,o.yg)("strong",{parentName:"p"},"projectile movement component")," what it needs to move! This will be our root component (the collision component). The function you need is ",(0,o.yg)("strong",{parentName:"p"},(0,o.yg)("inlineCode",{parentName:"strong"},"SetUpdatedComponent()")),". ")))),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Add the ",(0,o.yg)("strong",{parentName:"p"},(0,o.yg)("inlineCode",{parentName:"strong"},"FireInDirection()"))," function code, in ",(0,o.yg)("strong",{parentName:"p"},"Projectile.cpp"),". Because you pass in the direction you want to fire in, this is as simple as setting the velocity in the projectile movement component to be the normalized direction multiplied by our speed.")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Build the project to check the code is valid.  Run the program to open the UE5 Editor."))),(0,o.yg)("admonition",{type:"note"},(0,o.yg)("p",{parentName:"admonition"},(0,o.yg)("strong",{parentName:"p"},"Note"),": the static attribute, only stored once no matter how many projectile objects are created, is used so that its value can be accessed before an object is spawned \u2013 as shown later!  If you wanted a number of constants, a separate class, or enum class, with constants, would need to be added. ")),(0,o.yg)("ol",{start:8},(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Add Input Action mapping named Fire, which is activated by a Left Mouse Button click.  ")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Add code to the ",(0,o.yg)("strong",{parentName:"p"},"GD_Pawn")," that adds a function named void ",(0,o.yg)("strong",{parentName:"p"},(0,o.yg)("inlineCode",{parentName:"strong"},"Fire()")),"; and within the cpp file,  add code to ",(0,o.yg)("strong",{parentName:"p"},"'bind'")," the fire function to the ",(0,o.yg)("strong",{parentName:"p"},(0,o.yg)("inlineCode",{parentName:"strong"},"SetupPlayerInputComponent()"))," function, when a key is Pressed. ")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Create an empty definition  for the ",(0,o.yg)("inlineCode",{parentName:"p"},"Fire()")," function in the ",(0,o.yg)("strong",{parentName:"p"},"GD_Pawn.cpp")," file.  Save the changes in the UE5 Editor.")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Within the ",(0,o.yg)("strong",{parentName:"p"},"GD_Pawn.cpp")," file, ",(0,o.yg)("inlineCode",{parentName:"p"},"#include")," the Projectile header, just after the GD_Pawn header file include, at the top of the file.  ")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"In the ",(0,o.yg)("inlineCode",{parentName:"p"},"Fire()")," function:"))),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"Get the actor bounds and origin using the ",(0,o.yg)("strong",{parentName:"li"},"GetActorBounds()")," function. "),(0,o.yg)("li",{parentName:"ul"},"Define a ",(0,o.yg)("strong",{parentName:"li"},"projectionLocation")," as the ",(0,o.yg)("inlineCode",{parentName:"li"},"origin + (GetActorForwardVector *")," the static radius you set up earlier)."),(0,o.yg)("li",{parentName:"ul"},"Create a default ",(0,o.yg)("strong",{parentName:"li"},"FRotator")," using the ",(0,o.yg)("inlineCode",{parentName:"li"},"FRotator::ZeroRotator")," static. ")),(0,o.yg)("ol",{start:13},(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"We\u2019re going to wrap everything else in this function in if(GetWorld()) to make sure we are able to spawn.")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Now we need some Spawn Parameters. ",(0,o.yg)("strong",{parentName:"p"},(0,o.yg)("inlineCode",{parentName:"strong"},"FActorSpawnParams"))," is a container for a bunch of values you can set when you spawn an actor. Set ",(0,o.yg)("inlineCode",{parentName:"p"},"params->Owner")," to this and ",(0,o.yg)("inlineCode",{parentName:"p"},"params->Instigator")," to ",(0,o.yg)("strong",{parentName:"p"},"GetInstigator()"),".")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"After all this time it is time to create the projectile! The ",(0,o.yg)("strong",{parentName:"p"},"SpawnActor()")," function belongs to the World. Call this function like so:"),(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre",className:"language-cpp"},"AProjectile *proj = GetWorld()->SpawnActor<AProjectile>(AProjectile::StaticClass(),\n    projLoca, projRot, SpawnParams);\n"))),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"If creation is successful (test this by checking if your projectile is null), then call ",(0,o.yg)("strong",{parentName:"p"},"FireInDirection()")," on your new projectile. Pass in the forward vector of the current actor. ")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Run the program, to build and run the program, and check that a projectile is fired on a left mouse button press. You may want to add a small offset in the Z axis to move the spawn location a little away from the actor location to move the projectile up a bit."))),(0,o.yg)("h2",{id:"points-to-consider"},"Points to Consider"),(0,o.yg)("admonition",{type:"info"},(0,o.yg)("p",{parentName:"admonition"},"It should be noted we can, thus, create a 'complete' ",(0,o.yg)("strong",{parentName:"p"},"actor-based")," object that can be spawned, as, when, and where required - in this program, on the press of the left mouse button.\nYou should note that the static mesh and material paths are hard-coded within the code.  ",(0,o.yg)("strong",{parentName:"p"},"Is this good practice?"),"  If not, why not?\nYou should also note how the projectile static mesh is re-scaled so that it matches the collision sphere.",(0,o.yg)("br",{parentName:"p"}),"\n","At present, the projectiles move, but they do not ",(0,o.yg)("strong",{parentName:"p"},"'bounce'")," off the floor, for instance.")),(0,o.yg)("h2",{id:"exercises"},"Exercises"),(0,o.yg)("p",null,"It would be useful to have enemy objects to fire at."),(0,o.yg)("admonition",{type:"info"},(0,o.yg)("p",{parentName:"admonition"},"Firstly, we will revert to having the UE5 Editor separately controlled to VS2022.  Change the Solution Configuration to Development, and right-click over the Solution, in the Solution Explorer, and select Open Folder in File Explorer.  Close down VS2022. Double-click on the ",(0,o.yg)("strong",{parentName:"p"},".uproject")," file to open the project in the UE5 Editor.")),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Create a ",(0,o.yg)("strong",{parentName:"p"},"New C++ class")," named ",(0,o.yg)("inlineCode",{parentName:"p"},"Enemy"),", based on an ",(0,o.yg)("u",null,"Actor"),". In ",(0,o.yg)("strong",{parentName:"p"},"Enemy.h"),", add:"),(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre",className:"language-cpp"},'UPROPERTY(VisibleDefaultsOnly, Category = "Projectile")\nUCapsuleComponent *collisionComponent; // Capsule Collision Comp\nUStaticMeshComponent *staticMeshComponent;\nUMaterialInstanceDynamic *dynMaterial1;\n\nUFUNCTION()\nvoid OnHit(UPrimitiveComponent *HitComp, AActor *OtherActor,\n    UPrimitiveComponent* OtherComp, FVector NormalImpulse, const FHitResult& Hit);\n'))),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Add any includes you need.")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"In ",(0,o.yg)("strong",{parentName:"p"},"Enemy.cpp"),", in the constructor:"),(0,o.yg)("ul",{parentName:"li"},(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},"Create the components you just declared using ",(0,o.yg)("strong",{parentName:"p"},(0,o.yg)("inlineCode",{parentName:"strong"},"CreateDefaultSubObject<>()")),".")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},"Set the capsule size of the collision component using the ",(0,o.yg)("strong",{parentName:"p"},"InitCapsuleSize()")," method with a radius of ",(0,o.yg)("inlineCode",{parentName:"p"},"20.0f")," and a height of ",(0,o.yg)("inlineCode",{parentName:"p"},"50.0f"),".")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},"Enable physics simulation on your collision component by calling the ",(0,o.yg)("strong",{parentName:"p"},"SetSimulatePhysics()"),' method and passing "',(0,o.yg)("inlineCode",{parentName:"p"},"true"),'" as a parameter.')),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},'Set the collision profile of your collision component to "',(0,o.yg)("inlineCode",{parentName:"p"},"BlockAll"),'" by using the ',(0,o.yg)("strong",{parentName:"p"},"SetCollisionProfileName()")," method. You will need to use the TEXT() macro that Unreal provides.")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},"Enable collision detection on your collision component by calling the ",(0,o.yg)("strong",{parentName:"p"},"SetCollisionEnabled()"),' method and passing "',(0,o.yg)("inlineCode",{parentName:"p"},"ECollisionEnabled::QueryAndPhysics"),'" as a parameter.')),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},"Make your collision component the root component.")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},'Load a static mesh object named "',(0,o.yg)("inlineCode",{parentName:"p"},"/Engine/BasicShapes/Cylinder"),'" using the ',(0,o.yg)("strong",{parentName:"p"},"StaticLoadObject()"),' method and cast it to a "',(0,o.yg)("inlineCode",{parentName:"p"},"UStaticMesh"),'" type. (You did this earlier with the projectile).')),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},"If the mesh was successfully loaded, perform the following steps: "),(0,o.yg)("ul",{parentName:"li"},(0,o.yg)("li",{parentName:"ul"},"Assign the mesh to your static mesh component using the ",(0,o.yg)("strong",{parentName:"li"},"SetStaticMesh()")," method. "),(0,o.yg)("li",{parentName:"ul"},"Load the material \u201c",(0,o.yg)("inlineCode",{parentName:"li"},"MaterialInstanceConstant'/Engine/EditorMaterials/WidgetMaterial_Z'"),"\u201d using the ",(0,o.yg)("strong",{parentName:"li"},"FObjectFinder()")," method and create a dynamic material instance from it (again, see the projectile code)."),(0,o.yg)("li",{parentName:"ul"},"Set the dynamic material on the first material slot of your static mesh component. "),(0,o.yg)("li",{parentName:"ul"},"Calculate the scale values required to fit the mesh to the capsule size. ",(0,o.yg)("ul",{parentName:"li"},(0,o.yg)("li",{parentName:"ul"},"Find the bounds using ",(0,o.yg)("strong",{parentName:"li"},(0,o.yg)("inlineCode",{parentName:"strong"},"GetLocalBounds()")),"."),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"scaleXZ")," will be the ",(0,o.yg)("inlineCode",{parentName:"li"},"radius (20)/the bounds min.x"),"."),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"scaleZ")," is the ",(0,o.yg)("inlineCode",{parentName:"li"},"height (50)/ the bounds min.Z"),"."))),(0,o.yg)("li",{parentName:"ul"},"Apply the scale to your static mesh component using the ",(0,o.yg)("strong",{parentName:"li"},"SetWorldScale3D()")," method. "),(0,o.yg)("li",{parentName:"ul"},'Set the collision profile of your static mesh component to "',(0,o.yg)("inlineCode",{parentName:"li"},"NoCollision"),'" using the ',(0,o.yg)("strong",{parentName:"li"},(0,o.yg)("inlineCode",{parentName:"strong"},"SetCollisionProfileName()"))," method. "),(0,o.yg)("li",{parentName:"ul"},"Attach your static mesh component to the root component using the ",(0,o.yg)("strong",{parentName:"li"},(0,o.yg)("inlineCode",{parentName:"strong"},"SetupAttachment()"))," method."))),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},'Finish by loading a material "',(0,o.yg)("inlineCode",{parentName:"p"},"/Engine/EditorMaterials/WidgetMaterial_X"),'" using the ',(0,o.yg)("strong",{parentName:"p"},(0,o.yg)("inlineCode",{parentName:"strong"},"FObjectFinder()"))," method and initialise ",(0,o.yg)("inlineCode",{parentName:"p"},"dynMaterial1")," with the result."))))),(0,o.yg)("ol",{start:4},(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"The ",(0,o.yg)("strong",{parentName:"p"},"OnHit()")," function is called a delegate function, i.e. it is dynamically set, and called.  Add the following code in the ",(0,o.yg)("inlineCode",{parentName:"p"},"BeginPlay")," function, after the Super line:"),(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre",className:"language-cpp"},"collisionComponent->OnComponentHit.AddDynamic(this, &AEnemy::OnHit);\n")),(0,o.yg)("p",{parentName:"li"},"This is the same idea as binding your inputs like you have done previously."),(0,o.yg)("p",{parentName:"li"},(0,o.yg)("strong",{parentName:"p"},"Note: Intellisense will not find this, but it does exist. This is because it is a macro, not a function"),"."))),(0,o.yg)("ol",{start:5},(0,o.yg)("li",{parentName:"ol"},"Also add a stub function - i.e. defined, but it does NOT do anything - for ",(0,o.yg)("strong",{parentName:"li"},"OnHit"),".")),(0,o.yg)("h3",{id:"spawning-enemies-within-a-spawn-volume"},"Spawning Enemies within a Spawn Volume"),(0,o.yg)("p",null,"Next, let\u2019s spawn enemies within a specified area / volume."),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"In the UE5 Editor, create a ",(0,o.yg)("strong",{parentName:"p"},"New C++ class"),", based on ",(0,o.yg)("u",null,"Actor"),", named ",(0,o.yg)("strong",{parentName:"p"},"SpawnEnemy"),".")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Add the following to ",(0,o.yg)("em",{parentName:"p"},"SpawnEnemy.h"),":"),(0,o.yg)("ul",{parentName:"li"},(0,o.yg)("li",{parentName:"ul"},"A variable named ",(0,o.yg)("strong",{parentName:"li"},"spawnArea")," of type ",(0,o.yg)("strong",{parentName:"li"},(0,o.yg)("inlineCode",{parentName:"strong"},"UBoxComponent*")),". The ",(0,o.yg)("strong",{parentName:"li"},"UPROPERTY")," should be ",(0,o.yg)("u",null,"EditAnywhere"),"."),(0,o.yg)("li",{parentName:"ul"},"A function named ",(0,o.yg)("strong",{parentName:"li"},(0,o.yg)("inlineCode",{parentName:"strong"},"GetRandomPointInVolume()"))," that returns a ",(0,o.yg)("strong",{parentName:"li"},"FVector"),"."),(0,o.yg)("li",{parentName:"ul"},"A function named ",(0,o.yg)("strong",{parentName:"li"},(0,o.yg)("inlineCode",{parentName:"strong"},"SpawnEnemy()"))," that returns void."))),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Add any required includes.")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Within ",(0,o.yg)("strong",{parentName:"p"},"SpawnEnemy.cpp"),", include ",(0,o.yg)("inlineCode",{parentName:"p"},"enemy.h"),".")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Create spawnArea using ",(0,o.yg)("strong",{parentName:"p"},(0,o.yg)("inlineCode",{parentName:"strong"},"CreateDefaultSubobject<>()")),".")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Set the size of the box using the ",(0,o.yg)("strong",{parentName:"p"},"SetBoxExtent()")," method on ",(0,o.yg)("inlineCode",{parentName:"p"},"spawnArea")," with the parameters ",(0,o.yg)("strong",{parentName:"p"},"600.0, 500.0, 20.0"),".")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Attach ",(0,o.yg)("inlineCode",{parentName:"p"},"spawnArea")," to the ",(0,o.yg)("strong",{parentName:"p"},"RootComponent"),' by calling the "',(0,o.yg)("inlineCode",{parentName:"p"},"SetupAttachment"),'" method.')),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Now for ",(0,o.yg)("inlineCode",{parentName:"p"},"SpawnEnemy"),'. Start by checking if there is a valid world using the "',(0,o.yg)("inlineCode",{parentName:"p"},"GetWorld"),'" method.'))),(0,o.yg)("ol",{start:9},(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Inside the if statement:"),(0,o.yg)("ul",{parentName:"li"},(0,o.yg)("li",{parentName:"ul"},"Create a ",(0,o.yg)("strong",{parentName:"li"},"FActorSpawnParameters")," object named ",(0,o.yg)("strong",{parentName:"li"},"spawnParams"),"."),(0,o.yg)("li",{parentName:"ul"},"Set the ",(0,o.yg)("strong",{parentName:"li"},"Owner"),' parameter to "',(0,o.yg)("inlineCode",{parentName:"li"},"this"),'".'),(0,o.yg)("li",{parentName:"ul"},'Set the "',(0,o.yg)("inlineCode",{parentName:"li"},"Instigator"),'" parameter to the result of calling ',(0,o.yg)("strong",{parentName:"li"},"GetInstigator"),"."),(0,o.yg)("li",{parentName:"ul"},"Set the ",(0,o.yg)("strong",{parentName:"li"},"SpawnCollisionHandlingOverride"),' parameter of "',(0,o.yg)("inlineCode",{parentName:"li"},"spawnParams"),'" to "',(0,o.yg)("inlineCode",{parentName:"li"},"ESpawnActorCollisionHandlingMethod::AdjustIfPossibleButAlwaysSpawn"),'". This will ensure that, even if the spawn location has to move a little, it will still make sure to create the projectile. '),(0,o.yg)("li",{parentName:"ul"},"Call the ",(0,o.yg)("strong",{parentName:"li"},(0,o.yg)("inlineCode",{parentName:"strong"},"GetRandomPointInVolume()"))," function and store the result locally as the spawn location."),(0,o.yg)("li",{parentName:"ul"},"Create a ",(0,o.yg)("strong",{parentName:"li"},"FRotator")," object with a value of ",(0,o.yg)("strong",{parentName:"li"},"FRotator::ZeroRotator"),"."),(0,o.yg)("li",{parentName:"ul"},"Call the ",(0,o.yg)("strong",{parentName:"li"},"SpawnActor")," method on ",(0,o.yg)("strong",{parentName:"li"},"GetWorld")," with parameters:",(0,o.yg)("ul",{parentName:"li"},(0,o.yg)("li",{parentName:"ul"},"The class type ",(0,o.yg)("strong",{parentName:"li"},"AEnemy"),' obtained from "',(0,o.yg)("inlineCode",{parentName:"li"},"AEnemy::StaticClass()"),'".'),(0,o.yg)("li",{parentName:"ul"},"The spawn location value."),(0,o.yg)("li",{parentName:"ul"},"The zero rotator value."),(0,o.yg)("li",{parentName:"ul"},'The "',(0,o.yg)("inlineCode",{parentName:"li"},"spawnParams"),'" object.'))))),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"We would like to get a random point in the volume. We\u2019re going to do this using a built in utility function, based on the bounds of our spawn area. Add the following code to ",(0,o.yg)("strong",{parentName:"p"},"SpawnEnemy.cpp"),":"),(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre",className:"language-cpp"},"FVector ASpawnEnemy::getRandomPtInVolume() {\n    FVector spawnOrigin = whereToSpawn->Bounds.Origin;\n    FVector spawnExtent = whereToSpawn->Bounds.BoxExtent;\n    return UKismetMathLibrary::RandomPointInBoundingBox(spawnOrigin, spawnExtent);\n}\n")),(0,o.yg)("p",{parentName:"li"},"The above function uses a UE5 library, so we need to include it.  Add:"),(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre",className:"language-cpp"},'#include "Kismet/KismetMathLibrary.h" // for random in vol\n')),(0,o.yg)("p",{parentName:"li"},"After the other ",(0,o.yg)("inlineCode",{parentName:"p"},"#include")," lines in the cpp file.")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Within the ",(0,o.yg)("inlineCode",{parentName:"p"},"SpawnEnemy")," source file, in the ",(0,o.yg)("inlineCode",{parentName:"p"},"BeginPlay()")," function, spawn ",(0,o.yg)("strong",{parentName:"p"},"6")," Enemy objects using an appropriate for-loop."))),(0,o.yg)("ol",{start:12},(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Build the project to verify the code.")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Within the UE5 Editor, compile the program, and drag the ",(0,o.yg)("strong",{parentName:"p"},"SpawnEnemy")," icon, on to the Viewport, to create an object. Press Play, and enemies should be randomly placed.")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Save the map."))),(0,o.yg)("h3",{id:"handling-collisions"},"Handling Collisions"),(0,o.yg)("p",null,"Now we should make the projectile ",(0,o.yg)("strong",{parentName:"p"},"'bounce'")," off objects, and make the Enemy objects respond, as physically realistic objects."),(0,o.yg)("p",null,"Firstly, we need to make sure ",(0,o.yg)("strong",{parentName:"p"},"Projectiles")," ",(0,o.yg)("em",{parentName:"p"},"respond")," when they ",(0,o.yg)("strong",{parentName:"p"},"'hit'")," an object.  Do the following:"),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Add the following code, to the ",(0,o.yg)("strong",{parentName:"p"},"Projectile.cpp")," file, in the constructor, just before 'setting' the RootComponent to collisionComponent:"),(0,o.yg)("pre",{parentName:"li"},(0,o.yg)("code",{parentName:"pre",className:"language-cpp"},'collisionComponent->SetCollisionProfileName(TEXT("BlockAll"));\ncollisionComponent->SetCollisionEnabled(ECollisionEnabled::QueryAndPhysics);\n'))),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Within the UE5 Editor, compile and Run the program, to build and run the program."))),(0,o.yg)("admonition",{type:"tip"},(0,o.yg)("p",{parentName:"admonition"},"You should note that the projectile now responds when ",(0,o.yg)("strong",{parentName:"p"},"'hitting'")," objects.  Using ",(0,o.yg)("strong",{parentName:"p"},"'BlockAll'")," captures most collisions unless objects are specifically set not to. You should also note that the Enemies respond to being ",(0,o.yg)("strong",{parentName:"p"},"'hit'")," such that any forces / impulses applied to such objects should respond ",(0,o.yg)("strong",{parentName:"p"},"'realistically'"),".")),(0,o.yg)("h3",{id:"dynamically-changing-a-material-instance"},"Dynamically Changing A Material Instance"),(0,o.yg)("p",null,"When an Enemy is ",(0,o.yg)("strong",{parentName:"p"},"'hit'"),", it would be fun if we could change its appearance.  We can use the previously defined delegate function that will run, when a ",(0,o.yg)("strong",{parentName:"p"},"\u2018hit\u2019")," has been detected.  "),(0,o.yg)("admonition",{type:"note"},(0,o.yg)("p",{parentName:"admonition"},(0,o.yg)("strong",{parentName:"p"},"Note"),": An ",(0,o.yg)("strong",{parentName:"p"},"OnHit")," event may be generated if an enemy ",(0,o.yg)("strong",{parentName:"p"},"\u2018drops\u2019")," to the floor, so we do NOT want to change material for that.  The Floor has a mesh component that is set as static, i.e. it does not move, so if an ",(0,o.yg)("strong",{parentName:"p"},"OnHit")," event is generated, we can check that the component involved in the collision is NOT static, and then change material!")),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Within the ",(0,o.yg)("strong",{parentName:"p"},"Enemy.cpp")," in ",(0,o.yg)("strong",{parentName:"p"},"OnHit"),":"),(0,o.yg)("ul",{parentName:"li"},(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},"Check if the ",(0,o.yg)("strong",{parentName:"p"},"OtherActor")," is not a static root component by using ",(0,o.yg)("strong",{parentName:"p"},"IsRootComponentStatic"),".")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},"If the above check is false, call ",(0,o.yg)("strong",{parentName:"p"},"AddImpulseAtLocation()")," on ",(0,o.yg)("strong",{parentName:"p"},"HitComp")," with parameters:"),(0,o.yg)("ul",{parentName:"li"},(0,o.yg)("li",{parentName:"ul"},"The velocity of ",(0,o.yg)("inlineCode",{parentName:"li"},"OtherActor"),"."),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("inlineCode",{parentName:"li"},"Hit.ImpactPoint"),"."))),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},"Create a ",(0,o.yg)("strong",{parentName:"p"},"TArray")," object named ",(0,o.yg)("strong",{parentName:"p"},"components")," of type ",(0,o.yg)("strong",{parentName:"p"},(0,o.yg)("inlineCode",{parentName:"strong"},"UStaticMeshComponent*")),".")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},"Call ",(0,o.yg)("strong",{parentName:"p"},"GetComponents")," with template parameter ",(0,o.yg)("strong",{parentName:"p"},"UStaticMeshComponent")," pass in components.")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("p",{parentName:"li"},"If the first element of ",(0,o.yg)("strong",{parentName:"p"},"components")," exists and ",(0,o.yg)("strong",{parentName:"p"},"dynMaterial1")," is also not null, call ",(0,o.yg)("strong",{parentName:"p"},"SetMaterial")," on the first element of ",(0,o.yg)("strong",{parentName:"p"},"components")," with parameters:"),(0,o.yg)("ul",{parentName:"li"},(0,o.yg)("li",{parentName:"ul"},"The index 0."),(0,o.yg)("li",{parentName:"ul"},"The ",(0,o.yg)("strong",{parentName:"li"},"dynMaterial1")," object."))))),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Within the UE5 Editor, compile and Run the program, to build and run the program."),(0,o.yg)("p",{parentName:"li"},"You should note that the Enemies now respond to being ",(0,o.yg)("strong",{parentName:"p"},"'hit'")," such that the material changes from blue to red!  "))),(0,o.yg)("admonition",{type:"note"},(0,o.yg)("p",{parentName:"admonition"},(0,o.yg)("strong",{parentName:"p"},"Note")," how, in ",(0,o.yg)("strong",{parentName:"p"},"OnHit"),", a ",(0,o.yg)("inlineCode",{parentName:"p"},"TArray"),", in UE5, can store a ",(0,o.yg)("strong",{parentName:"p"},"\u2018dynamic\u2019")," array.  In this function, an array of static mesh components is stored \u2013 there is only 1 static mesh created for this object - and then the first one\u2019s material is changed!")),(0,o.yg)("h2",{id:"bonus-exercise"},"Bonus Exercise"),(0,o.yg)("p",null,"Add a static variable within ",(0,o.yg)("strong",{parentName:"p"},"Enemy.h")," as a public attribute, that keeps count of the number of hits.\nIt should display the number of hits on screen when a new hit happens. "),(0,o.yg)("p",null,(0,o.yg)("strong",{parentName:"p"},"Note:")," In a string building function, such as ",(0,o.yg)("strong",{parentName:"p"},(0,o.yg)("inlineCode",{parentName:"strong"},"Printf")),", ",(0,o.yg)("inlineCode",{parentName:"p"},"%s")," can substitute strings, and ",(0,o.yg)("inlineCode",{parentName:"p"},"%f")," can substitute float numbers.  You can do a lot of formatting with ",(0,o.yg)("strong",{parentName:"p"},(0,o.yg)("inlineCode",{parentName:"strong"},"Printf")),". Look for examples online."),(0,o.yg)("h2",{id:"more-points-to-consider"},"More Points to Consider"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"Why is a static needed ? Are there any issues with this approach ?"),(0,o.yg)("li",{parentName:"ul"},"It is worth reviewing the UE5 Editor, World Outliner, and Details panel, for each type of object.")))}A.isMDXComponent=!0}}]);