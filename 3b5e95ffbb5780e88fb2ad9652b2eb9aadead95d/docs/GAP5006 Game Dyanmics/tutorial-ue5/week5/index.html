<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-GAP5006 Game Dyanmics/tutorial-ue5/week5" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Week 5 - Artificial Intelligence | GameDev</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://mohammedfajer.github.io/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/img/"><meta data-rh="true" name="twitter:image" content="https://mohammedfajer.github.io/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/img/"><meta data-rh="true" property="og:url" content="https://mohammedfajer.github.io/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/docs/GAP5006 Game Dyanmics/tutorial-ue5/week5"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Week 5 - Artificial Intelligence | GameDev"><meta data-rh="true" name="description" content="Task Sheet 5 - Describes the systems available within Unreal Engine that can be use to create believable AI entities in your projects."><meta data-rh="true" property="og:description" content="Task Sheet 5 - Describes the systems available within Unreal Engine that can be use to create believable AI entities in your projects."><link data-rh="true" rel="icon" href="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/img/web_icon.ico"><link data-rh="true" rel="canonical" href="https://mohammedfajer.github.io/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/docs/GAP5006 Game Dyanmics/tutorial-ue5/week5"><link data-rh="true" rel="alternate" href="https://mohammedfajer.github.io/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/docs/GAP5006 Game Dyanmics/tutorial-ue5/week5" hreflang="en"><link data-rh="true" rel="alternate" href="https://mohammedfajer.github.io/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/docs/GAP5006 Game Dyanmics/tutorial-ue5/week5" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/blog/rss.xml" title="GameDev RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/blog/atom.xml" title="GameDev Atom Feed">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"><link rel="stylesheet" href="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/assets/css/styles.872396f0.css">
<script src="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/assets/js/runtime~main.a94f22f9.js" defer="defer"></script>
<script src="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/assets/js/main.a09f87b8.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_gu5v" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/"><div class="navbar__logo"><img src="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/img/web_icon_2.svg" alt="My Site Logo" class="themedComponent_ZRzL themedComponent--light_dGsa"><img src="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/img/web_icon_2.svg" alt="My Site Logo" class="themedComponent_ZRzL themedComponent--dark_pzCA"></div><b class="navbar__title text--truncate">Game Development</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/docs/intro">Tutorial</a><a class="navbar__item navbar__link" href="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/mohammedfajer/notes" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_T11m"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_kWbt colorModeToggle_GwZs"><button class="clean-btn toggleButton_fOL9 toggleButtonDisabled_STpu" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_DCeJ"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_DFgp"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_IP3a"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_IbdI"><div class="docsWrapper_JGIH"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_SdI4" type="button"></button><div class="docRoot_eRbX"><aside class="theme-doc-sidebar-container docSidebarContainer_Ta75"><div class="sidebarViewport_fgog"><div class="sidebar_oDHW"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_vPEQ"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/docs/intro">BSc Games Programming</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/docs/category/gap5005-games-hardware-development">GAP5005 Games Hardware Development</a><button aria-label="Expand sidebar category &#x27;GAP5005 Games Hardware Development&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/docs/category/gap5006-game-dynamics">GAP5006 Game Dynamics</a><button aria-label="Collapse sidebar category &#x27;GAP5006 Game Dynamics&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/docs/GAP5006 Game Dyanmics/">Module Info</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/docs/category/tutorial---unreal-engine-5">Tutorial - Unreal Engine 5</a><button aria-label="Collapse sidebar category &#x27;Tutorial - Unreal Engine 5&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/docs/GAP5006 Game Dyanmics/tutorial-ue5/week1">Week 1 - Introduction to UE5</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/docs/GAP5006 Game Dyanmics/tutorial-ue5/week2">Week 2 - Mouse Input and Spawning Game Objects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/docs/GAP5006 Game Dyanmics/tutorial-ue5/week3">Week 3 - Using C++ and Blueprint</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/docs/GAP5006 Game Dyanmics/tutorial-ue5/week4">Week 4 - Animation Blueprints</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/docs/GAP5006 Game Dyanmics/tutorial-ue5/week5">Week 5 - Artificial Intelligence</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/docs/GAP5006 Game Dyanmics/tutorial-ue5/week6">Week 6 - Grabbing and Throwing Objects</a></li></ul></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_lg0V"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_nDJs"><div class="docItemContainer_OGiL"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_k3Z9" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_JACu"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/docs/category/gap5006-game-dynamics"><span itemprop="name">GAP5006 Game Dynamics</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/docs/category/tutorial---unreal-engine-5"><span itemprop="name">Tutorial - Unreal Engine 5</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Week 5 - Artificial Intelligence</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_QCOD theme-doc-toc-mobile tocMobile_N0YI"><button type="button" class="clean-btn tocCollapsibleButton_pHwF">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Week 5 - Artificial Intelligence</h1></header>
<div class="theme-admonition theme-admonition-info admonition_LMjb alert alert--info"><div class="admonitionHeading_GGQ4"><span class="admonitionIcon_ifdW"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_pGk6"><p>Task Sheet 5 - Describes the systems available within Unreal Engine that can be use to create believable AI entities in your projects.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_FNw8" id="using-perception-sensing">Using Perception Sensing<a href="#using-perception-sensing" class="hash-link" aria-label="Direct link to Using Perception Sensing" title="Direct link to Using Perception Sensing">​</a></h2>
<p>At present, we have Enemies and a player / pawn object.  It would be useful if we could get the Enemies to respond when the player gets near.  UE5 has a sophisticated perception / sensing system.  The most simple approach is to sense when a player is within ‘sight’ and within a certain radius of the player.</p>
<p>We are going to add sensing to the Enemy objects, to achieve this. It would be useful if an <strong>Enemy</strong> could move towards a player, if a <strong>‘sensed’</strong> object is in its line of sight, and close enough to it.</p>
<p><strong>Do the following</strong>:</p>
<ol>
<li>
<p>Open the Project007 project in the UE5 Editor, then use menu option <strong>File</strong>, <strong>Refresh Visual Studio</strong>, and then <strong>File</strong>, <strong>Open Visual Studio</strong> option.</p>
</li>
<li>
<p>Within the <strong><code>Project007.Build.cs</code></strong> file, or similar, <u>change</u>:</p>
</li>
</ol>
<div class="language-cs codeBlockContainer_aalF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_MHx8"><pre tabindex="0" class="prism-code language-cs codeBlock_zHgq thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_RjmQ"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PublicDependencyModuleNames</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">AddRange</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name keyword" style="color:#00009f">string</span><span class="token constructor-invocation class-name punctuation" style="color:#393A34">[</span><span class="token constructor-invocation class-name punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Core&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;CoreUObject&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Engine&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			</span><span class="token string" style="color:#e3116c">&quot;InputCore&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;HeadMountedDisplay&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;EnhancedInput&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_Sd8_"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_LnQD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_t3l1"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_IiZV"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>By <u>adding</u> <strong>AIModule</strong> to the dependency module name, as follows:</p>
<div class="language-cs codeBlockContainer_aalF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_MHx8"><pre tabindex="0" class="prism-code language-cs codeBlock_zHgq thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_RjmQ"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PublicDependencyModuleNames</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">AddRange</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token constructor-invocation class-name keyword" style="color:#00009f">string</span><span class="token constructor-invocation class-name punctuation" style="color:#393A34">[</span><span class="token constructor-invocation class-name punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Core&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;CoreUObject&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Engine&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			</span><span class="token string" style="color:#e3116c">&quot;InputCore&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;HeadMountedDisplay&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;EnhancedInput&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;AIModule&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_Sd8_"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_LnQD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_t3l1"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_IiZV"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <code>AIModule</code> is used for perception sensing.</p>
<ol start="3">
<li>
<p>Add the following code towards the bottom of the Enemy class header:</p>
</li>
<li>
<p>Declare and define the following member variables within the class:</p>
<ul>
<li>
<p><strong><code>_aiPercComp</code></strong> - a pointer to a <code>UAIPerceptionComponent</code>, visible in defaults only and belonging to the <strong>&quot;Enemy&quot;</strong> category.</p>
</li>
<li>
<p><strong><code>_sightConfig</code></strong> - a pointer to a <code>UAISenseConfig_Sight</code>, visible in defaults only and belonging to the <strong>&quot;Enemy&quot;</strong> category.</p>
</li>
<li>
<p><strong><code>_baseLoc</code></strong> - an <code>FVector</code> visible anywhere and belonging to the <strong>&quot;Movement&quot;</strong> category.</p>
</li>
<li>
<p><strong><code>_currVelocity</code></strong> - an <code>FVector</code> visible and writable in blueprints and belonging to the <strong>&quot;Movement&quot;</strong> category.</p>
</li>
<li>
<p><strong><code>_speed</code></strong> - a float visible anywhere and belonging to the <strong>&quot;Movement&quot;</strong> category.</p>
</li>
<li>
<p><strong><code>_Radius</code></strong> - a float editable anywhere and belonging to the <strong>&quot;Enemy&quot;</strong> category.</p>
</li>
<li>
<p><strong><code>_distSquared</code></strong>, a float that we’re going to use for back to base calculations.</p>
</li>
<li>
<p><strong><code>_backToBase</code></strong> - a bool indicating whether the enemy should return to its base location.</p>
</li>
</ul>
</li>
<li>
<p>Declare a <code>UFUNCTION</code> called <strong>&quot;OnSensed()&quot;</strong> with a parameter of const <code>TArray&lt;AActor*&gt;&amp;</code> called <strong>“testActors”</strong>.</p>
</li>
</ol>
<div class="theme-admonition theme-admonition-info admonition_LMjb alert alert--info"><div class="admonitionHeading_GGQ4"><span class="admonitionIcon_ifdW"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_pGk6"><p>We are adding an AI Perception component, with a config attribute, <code>sightConfig</code>, that stores the settings for the sight sensing.  In addition, the <strong><code>OnSensed()</code></strong> function will run when an object has been sensed.</p><p>The other attributes are used to store where the start / base location of the Enemy is, and the current velocity direction, and speed, that the Enemy is moving at, if at all.</p></div></div>
<ol start="6">
<li>
<p>Within <code>Enemy.cpp</code>, add the required includes for <strong>UAIPerceptionComponent</strong> and <strong>UAISenseConfig</strong>. Forward declare in the <code>.h</code>!</p>
</li>
<li>
<p>Also, <strong>add</strong> the following code to the <strong>constructor</strong>:</p>
<ul>
<li>Add the following properties to the constructor:<!-- -->
<ul>
<li><strong>_currVelocity</strong>	: initialized as a zero vector</li>
<li><strong>_speed</strong>		: set to 30.0f</li>
<li><strong>_radius</strong>		: set to 500.0f</li>
<li><strong>_distSquared</strong>	: set to a defined big number</li>
<li><strong>_backToBase:</strong>	: set to false</li>
</ul>
</li>
<li>Create an AI Perception component within the constructor.</li>
<li>Create a sight configuration for the AI Perception component with the following settings:<!-- -->
<ul>
<li><strong>SightRadius</strong>: set to the previously defined radius value</li>
<li><strong>LoseSightRadius</strong>: set to the radius plus 100.0f</li>
<li><strong>PeripheralVisionAngleDegrees</strong>: set to 90.0f</li>
<li><strong>DetectionByAffiliation</strong>: set to detect enemies, neutrals, and friendlies</li>
<li><strong>SetMaxAge</strong>: set to 0.5f</li>
</ul>
</li>
<li>Configure the AI Perception component with the sight configuration using <code>“ConfigureSense”</code>, a member function of AIPerceptionComponent.</li>
<li>Set the dominant sense of the AI Perception component to be the sight configuration&#x27;s implementation using <code>“SetDominamtSense”</code>.</li>
<li>Add the following dynamic delegate to the <strong><code>OnPerceptionUpdated</code></strong> event of the AI Perception:</li>
</ul>
<div class="language-cpp codeBlockContainer_aalF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_MHx8"><pre tabindex="0" class="prism-code language-cpp codeBlock_zHgq thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_RjmQ"><span class="token-line" style="color:#393A34"><span class="token plain">	aiPercComp</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">OnPerceptionUpdated</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">AddDynamic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">AEnemy</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">OnSensed</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_Sd8_"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_LnQD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_t3l1"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_IiZV"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_LMjb alert alert--secondary"><div class="admonitionHeading_GGQ4"><span class="admonitionIcon_ifdW"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_pGk6"><p>This should create an AI Perception component with line of sight values set.  Note too that when an object is sensed, the OnSensed function will be called. That is the result of the above line of code. It works the same way you have bound input previously.</p></div></div>
</li>
<li>
<p>In the <strong>&quot;OnSensed()&quot;</strong> function:</p>
<ul>
<li>
<p>Iterate through the <strong>&quot;testActors&quot;</strong> array using a <strong>&quot;for&quot;</strong> loop.</p>
</li>
<li>
<p>Get the name of the <code>&quot;i-th&quot;</code> actor in the &quot;testActors&quot; array using the <strong>&quot;GetName()&quot;</strong> function and store it in a <code>FString</code> variable <strong>&quot;n&quot;</strong>.</p>
</li>
<li>
<p>Create a <code>&quot;FActorPerceptionBlueprintInfo&quot;</code> variable <strong>&quot;info&quot;</strong> and call the <strong>&quot;GetActorsPerception()&quot;</strong> function of <code>&quot;_aiPercComp&quot;</code> using <code>testActors[i]</code> and info as parameters to get the perception information of the <strong>&quot;i-th&quot;</strong> actor.</p>
</li>
<li>
<p>Check if the <strong>&quot;LastSensedStimuli&quot;</strong> array in &quot;info&quot; is not empty and the first element of the array was successfully sensed using its <strong>&quot;WasSuccessfullySensed()&quot;</strong> function.</p>
</li>
<li>
<p>If the above condition is true, calculate the direction vector <code>&quot;dir&quot;</code> by subtracting the location of the <strong>&quot;i-th&quot;</strong> actor from the location of the Enemy and set the <u>Z</u> component of <strong>&quot;dir&quot;</strong> to 0.0f.</p>
</li>
<li>
<p>Normalize the <code>&quot;dir&quot;</code> vector using the <strong>&quot;GetSafeNormal()&quot;</strong> function and multiply it with the <code>&quot;_speed&quot;</code> variable to get the current velocity of the Enemy.</p>
</li>
<li>
<p>Set the <strong>&quot;_currVelocity&quot;</strong> variable to the current velocity calculated in step (f).</p>
</li>
<li>
<p>If the condition in step (d) is false, calculate the direction vector <code>&quot;dir&quot;</code> by subtracting the <strong>&quot;_baseLoc&quot;</strong> variable from the location of the Enemy and set the <code>Z</code> component of <strong>&quot;dir&quot;</strong> to 0.0f.</p>
</li>
<li>
<p>Check if the squared 2D distance between <code>&quot;dir&quot;</code> and the Enemy is greater than <strong>1.0f</strong>.</p>
</li>
<li>
<p>If the above condition is true, normalize the <code>&quot;dir&quot;</code> vector using the <strong>&quot;GetSafeNormal()&quot;</strong> function and multiply it with the <code>&quot;_speed&quot;</code> variable to get the current velocity of the Enemy.</p>
</li>
<li>
<p>Set the <strong>&quot;_currVelocity&quot;</strong> variable to the current velocity calculated in the previous step and set the <code>&quot;_backToBase&quot;</code> variable to true.</p>
</li>
</ul>
</li>
</ol>
<div class="theme-admonition theme-admonition-tip admonition_LMjb alert alert--success"><div class="admonitionHeading_GGQ4"><span class="admonitionIcon_ifdW"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_pGk6"><p>Note how an array of actors, that are sensed, is made available to the <code>OnSensed()</code> function. The function <code>WasSuccessfullySensed()</code> is true when an appropriate object is in sight and within a certain radius of the Enemy.  When an object then moves out of sight, or outside of the required radius, <code>WasSuccessfullySensed()</code> will be false.  At present, a velocity is set for the Enemy to move towards a sensed object, and then return to its base location, if a sensed object ‘leaves’ its ‘proximity’.</p></div></div>
<p>We can now use the velocity within the Tick function, to move appropriately.</p>
<ol start="9">
<li>
<p>In the <strong>Tick</strong> function:</p>
<ul>
<li>
<p>Add an `&quot;if&quot;`` statement to check if <strong>&quot;_currVelocity&quot;</strong> is not zero.</p>
</li>
<li>
<p>If <strong>&quot;_currVelocity&quot;</strong> is not zero, calculate the new loc ation of the Enemy by adding <code>_currVelocity</code> multiplied by &quot;DeltaTime&quot; to the current location of the Enemy. (Think about your brackets!)</p>
</li>
<li>
<p>If <strong>&quot;_backToBase&quot;</strong> is true, check if the squared 2D distance between the new location and <code>&quot;_baseLoc&quot;</code> is less than <code>&quot;_distSquared&quot;</code>. The <strong>“SizeSquared2D()”</strong> function will help here.</p>
</li>
<li>
<p>If the squared 2D distance is less than <code>_distSquared</code>, update <code>_distSquared</code> to be equal to the squared 2D distance.</p>
</li>
<li>
<p>If the squared 2D distance is greater than <code>_distSquared</code>, set <code>_currVelocity</code> to be a zero vector, set <code>_distSquared</code> to be <strong>BIG_NUMBER</strong>, and set <code>_backToBase</code> to false.</p>
</li>
<li>
<p>Set the location of the Enemy to the new location calculated in step 5 using the <code>SetActorLocation()</code> function.</p>
</li>
</ul>
</li>
</ol>
<div class="theme-admonition theme-admonition-note admonition_LMjb alert alert--secondary"><div class="admonitionHeading_GGQ4"><span class="admonitionIcon_ifdW"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_pGk6"><p>We use <strong>SizeSquared2D()</strong>, for efficiency, does not use the <code>Z</code> direction, and doesn’t use a square root calculation, as we are only considering X and Y differences in position.</p><p>Finally, <strong>_baseLoc</strong> needs to be set for each Enemy.</p></div></div>
<ol start="10">
<li>Within <strong>BeginPlay</strong>, <u>add</u>:</li>
</ol>
<div class="language-cpp codeBlockContainer_aalF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_MHx8"><pre tabindex="0" class="prism-code language-cpp codeBlock_zHgq thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_RjmQ"><span class="token-line" style="color:#393A34"><span class="token plain">_baseLoc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GetActorLocation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_Sd8_"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_LnQD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_t3l1"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_IiZV"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>So that the base location is the starting pos of the AI.</p>
<p>Finally, we need to ‘register’ the Player as an object to be sensed.</p>
<ol start="11">
<li>
<p>Within <code>Project007Character.h</code> we would like the <strong>BeginPlay()</strong> function to run. Add the function. It should return void, take no parameters and should use the virtual and override keywords.</p>
</li>
<li>
<p><strong>Add</strong> the following include line, just after the other include files in <strong>Project007Character.cpp</strong>.</p>
</li>
</ol>
<div class="language-cpp codeBlockContainer_aalF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_MHx8"><pre tabindex="0" class="prism-code language-cpp codeBlock_zHgq thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_RjmQ"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&quot;Perception/AISense_Sight.h&quot;</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property comment" style="color:#999988;font-style:italic">// To Register Sight Sense</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&quot;Perception/AIPerceptionSystem.h&quot;</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property comment" style="color:#999988;font-style:italic">// To Register This Pawn</span><br></span></code></pre><div class="buttonGroup_Sd8_"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_LnQD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_t3l1"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_IiZV"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="13">
<li>Add the following code for the <strong>BeginPlay()</strong> function:</li>
</ol>
<div class="language-cpp codeBlockContainer_aalF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_MHx8"><pre tabindex="0" class="prism-code language-cpp codeBlock_zHgq thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_RjmQ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token class-name">AProject007Character</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">BeginPlay</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token class-name">Super</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">BeginPlay</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token class-name">UAIPerceptionSystem</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">RegisterPerceptionStimuliSource</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">GetWorld</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">UAISense_Sight</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">StaticClass</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_Sd8_"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_LnQD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_t3l1"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_IiZV"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>Super::BeginPlay()</code> just tells the code to run the base class <strong>BeginPlay()</strong> function, as well as our own, and the <code>RegisterPerceptionStimuliSource</code> is how we tell the perception system that we care about sight.</p>
<ol start="14">
<li>
<p>Build the VS2022 project.</p>
</li>
<li>
<p>Run the game and Play the game in the UE5 Editor.</p>
</li>
</ol>
<div class="theme-admonition theme-admonition-tip admonition_LMjb alert alert--success"><div class="admonitionHeading_GGQ4"><span class="admonitionIcon_ifdW"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_pGk6"><p>When the Player object moves to within a certain radius of an Enemy, the Enemy should move towards it.  When the Player object moves far enough away, the Enemy should move back to its base location.</p><p>Move the Player ‘behind’ an Enemy.  You should note that the Enemy does not respond to it!  At present, we have set an Enemy’s peripheral vision to 90° only.  Obviously, this can be changed, as required.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_FNw8" id="rotating-the-enemies">Rotating the Enemies<a href="#rotating-the-enemies" class="hash-link" aria-label="Direct link to Rotating the Enemies" title="Direct link to Rotating the Enemies">​</a></h2>
<p>At present, an Enemy will move towards a sensed object, within its field of view arc, or back to its base location, but it would be better if an Enemy rotated towards a player, in the direction it is moving in.</p>
<p><strong>Do the following</strong>:</p>
<ol>
<li>
<p>In the <code>Enemy.h</code> file, add a new public function called <strong>SetNewRotation()</strong> that takes two <code>FVector</code> parameters: one for target position and one for current position. Also, add a new member variable called <strong>_enemyRotator</strong> that will store the new rotation for the Enemy object.</p>
</li>
<li>
<p>In the <code>Enemy.cpp</code> file, define the <strong>SetNewRotation()</strong> function. Subtract the current position from the target position to get a direction vector. Set the <code>Z</code> value of the new direction to 0 to remove any vertical component. Compute the rotation needed to face the new direction by subtracting the current rotation from <code>newDir.Rotation()</code>. Store this new rotation in <strong>_enemyRotator</strong> and set the actor&#x27;s rotation to it using <code>SetActorRotation()</code>.</p>
</li>
<li>
<p>In the <code>OnSensed()</code> function, call <code>SetNewRotation()</code> with the location of the sensed actor and the current location of the Enemy object just before the end of the if statement.</p>
</li>
<li>
<p>In the else statement of the <code>OnSensed()</code> function, call <code>SetNewRotation()</code> with the location of the base and the current location of the Enemy object just before the end of the else statement.</p>
</li>
<li>
<p>Build and run the game in the UE5 Editor.</p>
</li>
</ol>
<p>The Enemy should now move towards the Player object and the Enemy should rotate to the initial <strong>‘sensed’</strong> position.  In addition, when moving back to the base location, the Enemy rotates in the direction it is moving back to.</p>
<p>The ‘full’ rotations are performed immediately, which is not ideal.  We will see that we can use interpolation to improve the rotations.</p>
<h2 class="anchor anchorWithStickyNavbar_FNw8" id="animating-the-enemies">Animating the Enemies<a href="#animating-the-enemies" class="hash-link" aria-label="Direct link to Animating the Enemies" title="Direct link to Animating the Enemies">​</a></h2>
<p>It would be useful to have the Enemies animated so that in an idle state, one set of animations is performed, but when an Enemy moves, it would be useful if we could use the ‘walk forward’ animations.</p>
<h3 class="anchor anchorWithStickyNavbar_FNw8" id="exercise">Exercise<a href="#exercise" class="hash-link" aria-label="Direct link to Exercise" title="Direct link to Exercise">​</a></h3>
<p>Please review <strong>worksheet 4 from week (4)</strong> regarding setting animations.</p>
<p>Within the <strong>Content Browser</strong>, (in the <strong>InfinityBladeWarriors</strong>, <strong>Character</strong>, <strong>CompleteCharacters</strong> folder), <strong>right-click</strong> on the <strong>SK_CharM_Forge</strong> asset and select, <strong>Skeleton</strong>, then <strong>Assign Skeleton</strong> and then select <strong>UE4_Mannequin_Skeleton</strong>, (in AnimStarterPack) and click on the <strong>Accept</strong> button.</p>
<p>Within the <strong>Content Browser</strong>, <strong>Right-click</strong> on the <strong>SK_CharM_Forge</strong> asset and select Create and then select <strong>Blend Space 1D</strong>. Change the <strong>name</strong> to <strong>ForgeBlendSpace</strong>. <strong>Double-click</strong> on <strong>ForgeBlendSpace</strong> to open the Animation editor. Blend between animations: <strong>Idle_Rifle_Hip</strong> and <strong>Walk_Fwd_Rifle_ironsights</strong>.</p>
<p><strong>Right-click</strong> on the <strong>SK_CharM_Forge</strong> asset and select <strong>Create</strong> and then select <strong>Anim Blueprint</strong>. <u>Change</u> the name to <strong>EnemyAnimBP</strong> and then <strong>Double-click</strong> it.</p>
<p>Create an <strong>AnimGraph</strong>, with a <strong>State machine</strong> labelled <strong>Idle_Walk</strong>, connect to the <strong>Output Pose</strong> node, <u>double-click</u> it and change it to look as follows:</p>
<div class="image-container"><img src="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/assets/images/w5_pic1-7448ad542f1a4cd6cdae22e588301050.png" width="50%" alt="Picture 0"></div>
<div class="theme-admonition theme-admonition-note admonition_LMjb alert alert--secondary"><div class="admonitionHeading_GGQ4"><span class="admonitionIcon_ifdW"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_pGk6"><p>Note: Create a <strong>new variable</strong> named: <strong>isWalking</strong> and ensure the transitions between the Idle state and walk state, use the <strong>isWalking</strong> variable, to set the result nodes, appropriately.</p></div></div>
<p>Ensure the <strong>Idle</strong> and <strong>Walk</strong> states have <strong>ForgeBlendSpace</strong> blend spaces <u>connected</u> to their <u>respective</u> <strong>Output Animation Pose</strong> nodes (remember to multiply by 100 for the Walk state).</p>
<p>We now need to update the animation based on whether the enemy is moving.  Click on the <strong>Event Graph</strong> panel, and like before, add the BP nodes, below:</p>
<div class="image-container"><img src="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/assets/images/w5_pic2-459a5a97379068bae010be870826f3ea.png" width="100%" alt="Picture 1"></div>
<p><strong>Compile</strong> and <strong>Save</strong> and <u>close</u> the window.</p>
<p>Finally, we need to amend the Enemy blueprint.</p>
<ol>
<li><strong>Double-click</strong> on the <strong>BP_Enemy</strong> blueprint.</li>
<li><strong>Click</strong> on the <u>Skeletal</u> <strong>Mesh</strong> in <strong>Components</strong>, and within the <strong>Details</strong> panel, select <strong>EnemyAnimBP</strong> from within <strong>Anim Class</strong>.</li>
<li><strong>Compile</strong> and <strong>Save</strong>.</li>
<li><strong>Run</strong> the game, and enemies should move and be animated too.</li>
</ol>
<p>Your enemies, should, initially, be in Idle state, and use the Idle animation.  When the pawn object is within an enemy’s radius and within sight, then the respective enemy should move towards the pawn object and use the walking animation.</p>
<h2 class="anchor anchorWithStickyNavbar_FNw8" id="improving-the-enemy-rotation">Improving the Enemy Rotation<a href="#improving-the-enemy-rotation" class="hash-link" aria-label="Direct link to Improving the Enemy Rotation" title="Direct link to Improving the Enemy Rotation">​</a></h2>
<div class="theme-admonition theme-admonition-tip admonition_LMjb alert alert--success"><div class="admonitionHeading_GGQ4"><span class="admonitionIcon_ifdW"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_pGk6"><p>At present, the Enemy objects move to / from a base location, and also rotate in the direction of the Enemy&#x27;s velocity. The rotation is completed, as soon as a &#x27;new&#x27; rotation is required, i.e. in one frame.  It would look better if the rotation was more slowly completed.</p><p>It would be useful if it could rotate to a position in a few frames, rather than in one frame.  What if we could calculate a series of rotations so that the final rotation is achieved in a series of steps.  As such, the rotations look much more realistic and appealing.</p><p>This is the idea of interpolation.  We calculate position / rotation stages between an initial and final position / rotation!</p></div></div>
<p><strong>Do the following</strong>:</p>
<ol>
<li>Within <code>Enemy.h</code>, add the following variables to the public section:<!-- -->
<ul>
<li>float <strong>_rotationSpeed</strong> – this should be editable from anywhere.</li>
<li>bool <strong>_interpRotation</strong> – this shouldn’t be accessed outside of code.</li>
</ul>
</li>
<li>In the constructor of <code>Enemy.cpp</code>, set <strong>_interpRotation</strong> to be false and <strong>_rotationSpeed</strong> to be 1.</li>
<li>In the <strong>OnSensed()</strong> function, set <strong>_interpRotation</strong> to true just before the if statement that checks if the actor was successfully sensed.</li>
<li>Update the <strong>SetNewRotation()</strong> function to the following:<!-- -->
<ul>
<li>Get the difference vector between the target position and the current position and ignore any difference in the Z-axis.</li>
<li>Set the <strong>_enemyRotator</strong> variable to this rotation.</li>
<li>If <strong>_interpRotation</strong> is true, set the rotation using <strong>RInterpTo</strong> function with the current rotation, <strong>_enemyRotator</strong>, and <strong>DeltaTime</strong>.</li>
<li>If <strong>_interpRotation</strong> is false, set the rotation directly using <strong>SetActorRotation()</strong> function, like you are currently doing.</li>
</ul>
</li>
<li>In the <strong>Tick()</strong> function, if <strong>_interpRotation</strong> is true, calculate the new rotation using <strong>RInterpTo</strong> function with the current rotation, <strong>_enemyRotator</strong>, DeltaTime, and <strong>_rotationSpeed</strong>. If the new rotation is nearly equal to <strong>_enemyRotator</strong>, set <strong>_interpRotation</strong> to false and set the rotation directly using <strong>SetActorRotation</strong> function.</li>
</ol>
<p>Note how an Enemy object now rotates to the required orientation, over a <u>number</u> of frames, using the <strong>RInterpTo()</strong> function.  Whilst playing the game, press the <strong>F8</strong> key to stop &#x27;playing&#x27;, but be able to edit within the UE5 Editor.  Click on an <strong>Enemy</strong> object and <u>adjust</u> the &#x27;rotation speed&#x27; value.  Set &#x27;rotation speed&#x27; values ranging from 0.1 to 5.0, for different Enemies. Consider the &#x27;best&#x27; value for your game.</p>
<p>Interpolation, essentially, calculates different points between a start and end value.  For example, 20 different positions may be calculated, based upon the speed value selected.</p>
<p>Interpolation can also be applied to linear values, in fact that is how a blend space is calculated, where numerous values between <code>0.0</code> and <code>100.0</code> are calculated, which changes which animation frames are selected.</p>
<h2 class="anchor anchorWithStickyNavbar_FNw8" id="points-to-consider">Points to Consider<a href="#points-to-consider" class="hash-link" aria-label="Direct link to Points to Consider" title="Direct link to Points to Consider">​</a></h2>
<p>Some AI perception values are hard-coded.  Would it be better if such values were set as editable properties in the UE5 editor?</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/docs/GAP5006 Game Dyanmics/tutorial-ue5/week4"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Week 4 - Animation Blueprints</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/notes/3b5e95ffbb5780e88fb2ad9652b2eb9aadead95d/docs/GAP5006 Game Dyanmics/tutorial-ue5/week6"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Week 6 - Grabbing and Throwing Objects</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_IS5x thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#using-perception-sensing" class="table-of-contents__link toc-highlight">Using Perception Sensing</a></li><li><a href="#rotating-the-enemies" class="table-of-contents__link toc-highlight">Rotating the Enemies</a></li><li><a href="#animating-the-enemies" class="table-of-contents__link toc-highlight">Animating the Enemies</a><ul><li><a href="#exercise" class="table-of-contents__link toc-highlight">Exercise</a></li></ul></li><li><a href="#improving-the-enemy-rotation" class="table-of-contents__link toc-highlight">Improving the Enemy Rotation</a></li><li><a href="#points-to-consider" class="table-of-contents__link toc-highlight">Points to Consider</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Mohammed Fajer, University of Bolton.</div></div></div></footer></div>
</body>
</html>